<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.w3.org/1999/xhtml">
<head>

    <title>Show preview font</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" href="css/font.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/testingPage.css">
    <link href="style.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/selectionInput.css">
    <script type="text/javascript" src="js/examination.js"></script>
    <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">-->
<!--    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>-->
<!--    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>-->
<!--    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>-->
    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

    <style>
        /* CSS comes here */
        body {
            font-family: arial;
        }
        button {
            padding:10px;
            background-color:#6a67ce;
            color: #FFFFFF;
            border: 10px;
            cursor:pointer;
            border-radius: 5px;
        }
        #output {
            background-color:#F9F9F9;
            padding:10px;
            width: 100%;
            margin-top:20px;
            line-height:30px;
        }
        #btn-speech{
            /*padding:10px;*/
            /*border: 10px;*/
            margin-bottom:11px;
        }
        .hide {
            display:none;
        }
        .show {
            display:block;
        }
    </style>

</head>
<body onload="examinationSpeech()">
<section id="counts" class="counts">
<div id="right" align ="left" style="font-size: 40px;padding-left: 5% ;margin-bottom: -4%;display: none" hidden> R </div>
<div id="right_ph" align ="left" style="font-size: 40px;padding-left: 5% ;margin-bottom: -4%;display: none"hidden> R ph </div>
<div id="left" align ="left" style="font-size: 40px;padding-left: 5% ;margin-bottom: -4%;display: block"> L </div>
<div id="left_ph" align ="left" style="font-size: 40px;padding-left: 5% ;margin-bottom: -4%;display: none"> L ph </div>
<div id="distance_numTemp" align ="right" style="font-size: 40px ;padding-right: 5% ; margin-bottom: -11%"> 6/60 </div>
<br><br><br><br><br><br><br><br>
<div class="center" style="display: none" id="list" >
    <div style="font-size: 250% ;display: block" id="demo1" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo2" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo3" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo4" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo5" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo6" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo7" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo8" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo9" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo10" value=""></div>
    <div style="font-size: 250% ;display: none" id="demo11" value=""></div>
    <br>

    <label style="font-size:100px">ใส่คำตอบ :</label>
    <input type="text" id="Answer" onchange="" style="height:250px; font-size:180pt; width:700px;">
    <input type="text" id="Answer2" onchange="" style="height:250px; font-size:180pt; width:700px;" autocomplete="off">
    <button type="button" class="btn btn-outline-secondary" onclick="runSpeechRecognition()" id="btn-speech" style="margin-top: -5%; height:250px; width:300px;">
        <svg xmlns="http://www.w3.org/2000/svg" width="200px" height="200px" fill="currentColor" class="bi bi-mic" viewBox="0 0 16 16">
        <path d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"/>
        <path d="M10 8a2 2 0 1 1-4 0V3a2 2 0 1 1 4 0v5zM8 0a3 3 0 0 0-3 3v5a3 3 0 0 0 6 0V3a3 3 0 0 0-3-3z"/>
    </svg>
    <span class="visually-hidden"></span>
</button>
    <button class="btn btn-secondary"  id="big-button2" onclick="backline()">Back</button>
    <button class="btn btn-primary" id="big-button1" onclick="nextline()">Next</button>
    <div id="output" class=""></div>
    <button class="btn btn-primary" id="btnOk" style="margin-top: -1%; font-size: 50px" onclick="checkSpeechText()">ยืนยันคำตอบ</button>
    <br>&nbsp; <span id="action"></span></p>
    <input id="right_s_wrong" hidden>
    <input id="right_s_acuity" hidden>
    <input id="right_pin_s_wrong" hidden>
    <input id="right_pin_s_acuity" hidden>

</div>



</div>
<!-- Button trigger modal -->
<button id="btn_show_modal2" data-toggle="modal" data-target="#staticBackdrop2" hidden>open modal</button>
<button onclick="show_info_left_eye()" hidden >show modal</button>
<!--        <button  id="btn_link" type="button" class="btn btn-success" ><a id="link_to_result" href="../examinationResult">Close</a></button>-->
<!-- Modal -->
    <div class="modal fade" id="staticBackdrop2"  role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel2">คำแนะนำสำหรับตาซ้าย</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <!--                                            <span aria-hidden="true">&times;</span>-->
                    </button>
                </div>
                <div class="modal-body">
                    <input id="check_enter_to_close2"  style="width: 0px ; padding: 0px ; border: 1px solid" onkeypress="checkEnter2()" >
                    <label style="font-size: 18px">นำอุปกรณ์ตรวจวัดสายตามาทาบโดยให้เปิดตาซ้ายไว้ตามรูป</label>
                    <img class="card-img-top" src="img_ex_testEye/left-eye.png" alt="Card image cap" style="width:100%">
                </div>
                <div class="modal-footer">
                    <a  id="close_modal2" onclick="click_for_close()" data-dismiss="modal" class="btn btn-primary">ตกลง</a>
                </div>
            </div>
        </div>
    </div>
<button id="btn_show_modal3" data-toggle="modal" data-target="#staticBackdrop3" hidden>open modal</button>
<button onclick="show_info_left_eye()" hidden >show modal</button>
<!--        <button  id="btn_link" type="button" class="btn btn-success" ><a id="link_to_result" href="../examinationResult">Close</a></button>-->
<!-- Modal -->
    <div class="modal fade" id="staticBackdrop3" role="dialog" aria-labelledby="myModalLabel" aria-hidden="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel3">คำแนะนำสำหรับตาซ้าย และ pinhole</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <!--                                            <span aria-hidden="true">&times;</span>-->
                    </button>
                </div>
                <div class="modal-body">
                    <input id="check_enter_to_close3"  style="width: 0px ; padding: 0px ; border: 1px solid" onkeypress="checkEnter3()" >
                    <label style="font-size: 18px">นำอุปกรณ์ตรวจวัดสายตามาทาบและทำการมองผ่านรูเล็ก <br> ดังภาพ</label>
                    <img class="card-img-top" src="img_ex_testEye/left-pinhole.png" alt="Card image cap" style="width:100%">
                </div>
                <div class="modal-footer">
                    <a id="close_modal" onclick="click_for_close()" data-dismiss="modal" class="btn btn-primary">ตกลง</a>
                </div>
            </div>
        </div>
    </div>

<!-- Button trigger modal -->
<button id="btn_show_modal" data-toggle="modal" data-target="#staticBackdrop" hidden>open modal</button>
<button onclick="show_modal()" hidden >show modal</button>
<!--        <button  id="btn_link" type="button" class="btn btn-success" ><a id="link_to_result" href="../examinationResult">Close</a></button>-->
<!-- Modal -->
    <div class="modal fade" id="staticBackdrop" data-backdrop="static" data-keyboard="false" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="staticBackdropLabel">แจ้งเตือน</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <!--          <span aria-hidden="true">&times;</span>-->
                    </button>
                </div>
                <div class="modal-body">
                    จบการทดสอบวัดสายตา
                    <input id="check_enter_to_close"  style="width: 0px ; padding: 0px ; border: 1px solid" onkeypress="checkEnter()" >
                </div>
                <div class="modal-footer">
                    <a id="next_test" href="examinationResult" class="btn btn-primary">ตกลง</a>
                </div>
            </div>
        </div>
    </div>

<br><br><br><br><br><br><br>
<script th:inline="javascript">
    function ReadData() {
        var optotype = /*[[${optotype}]]*/ 'default';
        var distance = /*[[${distance}]]*/ 'default'; //text=69lenght
        var pass_text = /*[[${passtext}]]*/ 'default';

        var right_s_wrong = /*[[${right_s_wrong}]]*/ 'default';
        var right_s_acuity = /*[[${right_s_acuity}]]*/ 'default'; //text=69lenght
        var right_pin_s_wrong = /*[[${right_pin_s_wrong}]]*/ 'default';
        var right_pin_s_acuity = /*[[${right_pin_s_acuity}]]*/ 'default';
        var m = 0;
        var value = pass_text;
        var text = "";
        var text2 = "";
        var text3 = "";
        var text4 = "";
        var text5 = "";
        var text6 = "";
        var text7 = "";
        var text8 = "";
        var text9 = "";
        var text10 = "";
        var text11 = "";
        for (var i = 0; i < value.length; i++) {
            if(i < 9){
                text = text + value[i] + "&nbsp";
            }else if(i < 19){
                text2 = text2 + value[i] + "&nbsp";
            }else if(i < 29){
                text3 = text3 + value[i] + "&nbsp";
            }else if(i < 39){
                text4 = text4 + value[i] + "&nbsp";
            }else if(i < 49){
                text5 = text5 + value[i] + "&nbsp";
            }else if(i < 59){
                text6 = text6 + value[i] + "&nbsp";
            }else if(i < 69){
                text7 = text7 + value[i] + "&nbsp";
            }else if(i < 79){
                text8 = text8 + value[i] + "&nbsp";
            }else if(i < 89){
                text9 = text9 + value[i] + "&nbsp";
            }else if(i < 99){
                text10 = text10 + value[i] + "&nbsp";
            }else if(i < 109){
                text11 = text11 + value[i] + "&nbsp";
            }
        }
        document.getElementById('demo1').innerHTML = text;
        document.getElementById('demo2').innerHTML = text2;
        document.getElementById('demo3').innerHTML = text3;
        document.getElementById('demo4').innerHTML = text4;
        document.getElementById('demo5').innerHTML = text5;
        document.getElementById('demo6').innerHTML = text6;
        document.getElementById('demo7').innerHTML = text7;
        document.getElementById('demo8').innerHTML = text8;
        document.getElementById('demo9').innerHTML = text9;
        document.getElementById('demo10').innerHTML = text10;
        document.getElementById('demo11').innerHTML = text11;
        changeFontFamily(optotype);
        changeDistance(distance);
        document.getElementById('right_s_wrong').value = right_s_wrong;
        document.getElementById('right_s_acuity').value = right_s_acuity;
        document.getElementById('right_pin_s_wrong').value = right_pin_s_wrong;
        document.getElementById('right_pin_s_acuity').value = right_pin_s_acuity;
    }
    /*]]>*/
</script>

<script>
    function sendAjax(temp_left_s_wrong ,temp_left_s_acuity ,temp_left_pin_s_wrong , temp_left_pin_s_acuity){
        var eyeResult = {};
        var right_s_wrong = document.getElementById('right_s_wrong').value;
        var right_s_acuity = document.getElementById('right_s_acuity').value;
        var right_pin_s_wrong = document.getElementById('right_pin_s_wrong').value;
        var right_pin_s_acuity = document.getElementById('right_pin_s_acuity').value;
        eyeResult["left_s_wrong"] = temp_left_s_wrong;
        eyeResult["left_s_acuity"] = temp_left_s_acuity;
        eyeResult["left_pin_s_wrong"] = temp_left_pin_s_wrong;
        eyeResult["left_pin_s_acuity"] = temp_left_pin_s_acuity;
        eyeResult["right_s_wrong"] = right_s_wrong;
        eyeResult["right_s_acuity"] = right_s_acuity;
        eyeResult["right_pin_s_wrong"] = right_pin_s_wrong;
        eyeResult["right_pin_s_acuity"] = right_pin_s_acuity;
        console.log(eyeResult)
        $.ajax({

            url:"eyeResult",

            type: 'POST',

            data:  JSON.stringify(eyeResult),

            dataType: "json",

            contentType: 'application/json',

            mimeType: 'application/json',

            success: function(data){

                console.log("send success");

                return false;

            }

        });
        show_modal()
    }
    function checkEnter3(){
        var input = document.getElementById("check_enter_to_close3");
        input.addEventListener("keyup", function(event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("close_modal").click();
                document.getElementById("Answer2").focus();
            }
        });
    }
    $(document).ready(function(){
        $('#staticBackdrop3').on('shown.bs.modal', function () {
            $('#check_enter_to_close3').focus();
        })
    });
    function checkEnter2(){
        var input = document.getElementById("check_enter_to_close2");
        input.addEventListener("keyup", function(event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("close_modal2").click();
                document.getElementById("Answer2").focus();
            }
        });
    }
    $(document).ready(function(){
        $('#staticBackdrop2').on('shown.bs.modal', function () {
            $('#check_enter_to_close2').focus();
        })
    });

    function checkEnter(){
        var input = document.getElementById("check_enter_to_close");
        input.addEventListener("keyup", function(event) {
            if (event.keyCode === 13) {
                event.preventDefault();
                document.getElementById("next_test").click();
            }
        });
    }
    $(document).ready(function(){
        $('#staticBackdrop').on('shown.bs.modal', function () {
            $('#check_enter_to_close').focus();
        })
    });
    function click_for_close(){
        document.getElementById("Answer2").focus();
    }
</script>
    </section>
</body>
</html>
